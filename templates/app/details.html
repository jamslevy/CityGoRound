{% extends 'base.html' %}

{% block headscripts %}
<link rel="stylesheet" type="text/css" href="/css/jquery.rating.css" media="screen" />
<script type="text/javascript" src="/js/jquery.rating.pack.js"></script>
{% endblock %}

{% block extra_head %}

    <script type="text/javascript">
    
    function react_to_vote( data ) {
      average_rating = data[0];
      num_ratings = data[1];
    
      $("#ratings").html("average "+average_rating+"/5 over "+num_ratings+" votes");
    }
    
     $(document).ready(function(){
     
       $('.auto-submit-star').rating({ 
         callback: function(value, link){
                     $.getJSON( "/admin/apps/rating/", {'app_key_id':'{{transit_app.key.id}}','rating':value}, react_to_vote );
                     document.cookie ='{{transit_app.key.id}}='+value+'; expires=Thu, 2 Aug 2010 20:47:11 UTC; path=/';
                   } 
       });
     
     });

    </script>

{% endblock %}

{% block title %}Open Transit Data &raquo; Details For {{transit_app.title}}{% endblock %}

{% block content %}

    <!-- TODO jesse: add some design here. (dave) -->
    
    <div id="app-details" class="body-content">    
        <h2>{{transit_app.title}} DETAILS:</h2>
        Ratings: <div id="ratings">average {{transit_app.average_rating}}/5 over {{transit_app.num_ratings}} votes</div>
        <div id="votebooth">
        Your rating:<form name="rating" action="/app/rating" method="POST">
        <input type="radio" name="rating" value="1" onchange="vote(this.value);" class="auto-submit-star">
        <input type="radio" name="rating" value="2" onchange="vote(this.value);" class="auto-submit-star">
        <input type="radio" name="rating" value="3" onchange="vote(this.value);" class="auto-submit-star">
        <input type="radio" name="rating" value="4" onchange="vote(this.value);" class="auto-submit-star">
        <input type="radio" name="rating" value="5" onchange="vote(this.value);" class="auto-submit-star">
        </form>
        </div>
        <br>
        
        <table>
            <tr>
                <th>Description:</th>
                <td>{{transit_app.description}}</td>
            </tr>
            <tr>
                <th>Homepage:</th>
                <td><a href="{{transit_app.url}}">{{transit_app.url}}</a></td>
            </tr>
            <tr>
                <th>Author Name:</th>
                <td>{{transit_app.author_name}}</td>
            </tr>
            <tr>
                <th>Long Description:</th>
                <td>{{transit_app.long_description}}</td>
            </tr>
            <tr>
                <th>Tags:</th>
                <td>TODO DAVEPECK</td>
            </tr>
            <tr>
                <th>Screen Shot:</th>
                <td><img src="{{transit_app.screen_shot_url}}" alt="Application Screen Shot" /></td>
            </tr>
        </table>
    </div>
{% endblock %}


{% block scripts %}
{% endblock %}
